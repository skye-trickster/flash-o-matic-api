# SQL (PostgreSQL) Review

## NOTE
This is in progress for studying purposes. Not going to bog down the review notes over this.

## Basics
- Tables are used to store data in databasess
- Tables have a fixed number of columns and any number of rows
- Each column has a name and a data type asssociated with it 
    - data type will determine file size of column too
- Table rows are identified using **primary keys** (ex. an `integer` named `id`)
    - No two rows have the same primary key (ex. no two rows have an `id` of 1)
    - You can have more than one primary key
- Database relationships:
    - Relationships between tables are made using primary keys (can use `id` of one table and use it to make a relationship with antoher table.)
    - Types of database relationships:
        1. one-to-one relationships: 1 record in `Table A` relates to multiple in `Table B` (one student, one school ID card)
        2. one-to-many relationships: 1 record in `Table A` relates to multiple records in `Table B` (one deck, multiple cards)
        3. many-to-many relationships: multiple records in `Table A` relates to multiple records in `Table B` (multiple songs, multiple genres)
            - typically should make a relationship table to help make the many-to-many connection
            - ex: `songs` and `genres` are many-to-many. Create a `songs_genres` table to help make the relationship
            - Composite Key: primary key that uses columns from other tables to guarantee uniqueness
                - should use this for many-to-many relationships

### Common Data Types
Type | Definition | Example | Additional Notes
:-- | :-- | :-- | :--
`BOOL` | `TRUE` or `FALSE` | `TRUE` | --
`CHAR` | fixed-length character data | `CHAR(5)`, `19123` (zip code) | must have that specific length of characters
`VARCHAR` | variable length character data.  | `VARCHAR(255)`, `wordle time?` | sets a max character length when creating a new column. data cannot exceed that max length. 
`INT` / `INTEGER` | whole number | `34`, `-552` | 32-bit integer. positive or negative. `-2,147,483,648` < x < `2,147,483,647`
`NUMERIC` | an exact number or a float | `3.14159` | --
`SMALLINT` | 16-bit integer | `-56` | 16-bits. Positive or negative. `-32,768` < x < `32,768`
`SERIAL` | 32-bit auto incrementing integer | `45` | Always positive. Automatically increments. x < `2,147,483,647`
`SMALL SERIAL` | 16-bit auto incrementing integer | `56` | Always positive. Automatically increments. x < `32,768`
`TEXT` | varying character length text | `TIME FOR GAMES` | similar to `VARCHAR` but don't set a max character limit
`DATE` | calendar date without time | `2022-05-08` | always in `YYYY-MM-DD` format
`TIME` | Time without date | `13:55:23` | always in `HH:MM:SS` format; 24-hour time
`TIMESTAMP` | Date and time | `2022-05-08 13:55:23` | always in `YYYY-MM-DD HH:MM:SS` format; 24-hour time; in UTC (GMT+0)
`UUID` | Universal Unique Identifier | `4192bff0-e1e0-43ce-a4db-912808c32493` | 128-bits. [Click Here](https://cloud.google.com/bigquery/docs/reference/standard-sql/uuid_functions) for information about UUIDs

### SQL COMMANDS

#### CREATE TABLE
Syntax: 
```postgres
CREATE TABLE table_name ( -- table_name is the table's name
    column_name data_type column_constraints [,]
        -- column_name: the name of the column
        -- data_type: the data type of the column
        -- column_constraints: the constraints, if any, of the column
        -- separate columns by using a comma (,)
)
```
Some columns require constraints in order for that column to be validated.

Common constraints:
- `PRIMARY KEY`: sets column as the primary key. No two rows can have the same key
    - `GENERATED BY DEFAULT`: Iterate and generate a new primary key
- `NOT NULL`: this column CANNOT be `NULL` (blank) for a given row
- `DEFAULT`: not setting this column will give it a default value
    - Example: `deck_name text default 'blank'`: (decks without a name will be given the name "blank" by default) 
    - Special: `DEFAULT CURRENT_TIMESTAMP`: Sets the column to the current timestamp. Useful for date_created columns
- `UNIQUE`: No two rows can have the same value
    - `PRIMARY KEY` automatically has this constraint

Example: 
```postgres
CREATE TABLE decks (
    deck_id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    deck_name VARCHAR(255) NOT NULL,
    deck_description TEXT,
    date_created TIMESTAMP DEFAULT CURRENT_TIMESTAMP, --date 
    date_modified TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### Query Tables via "`SELECT ... FROM ... WHERE ...`"

Syntax: 
```postgres
SELECT <column_names>
FROM <table_name>
WHERE <conditions>
```

Some special things to filter by:
- `TIMESTAMP 'yesterday'`: the timestamp for yesterday's date at midnight
- `date_created + interval '1 day'`: 24 hours after the date the deck was created. 

Example:

```postgres
SELECT deck_id, deck_name
FROM deck
WHERE date_created > TIMESTAMP 'yesterday' -- checks for all decks created yesterday and today
```